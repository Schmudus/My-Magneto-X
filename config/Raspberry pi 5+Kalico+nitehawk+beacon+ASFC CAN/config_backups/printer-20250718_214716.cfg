[include beacon.cfg]
[include mainsail.cfg]
[include client_variable.cfg]
[include magneto_device.cfg]
[include magneto_toolhead.cfg]
[include shell_command.cfg]
[include macros.cfg]
[include bt_macro.cfg]
#[include timelapse.cfg]
[include stepper.cfg]
#[include TMC2240.cfg]
[include TMC5160.cfg]
[include temperatures.cfg]
[include neopixel.cfg]
[include fan_tach_monitor.cfg]
[include danger_options.cfg]
#[include shaketune.cfg]
[include AFC/*.cfg]
[include test_print.cfg]
[include TEST_SPEED.cfg]
[skew_correction]
[exclude_object]
[save_variables]
filename: ~/printer_data/config/variables.cfg
  
[idle_timeout]
gcode:
    {% if printer.pause_resume.is_paused %}
        M104 S0
    {% else %}
        LM_DISABLE
        TURN_OFF_HEATERS
        M84
        M118 Idle timeout
    {% endif %}
timeout: 3600

[gcode_arcs]
resolution: 0.1

[force_move]
enable_force_move: True

#####################################################################
#	Gantry level and Mesh
#####################################################################

[quad_gantry_level]
gantry_corners:
    -96,-78.5
    353.5,437

points:
  25,25
  25,350
  283,350
  283,25

speed: 350
horizontal_move_z: 10
retries: 8
retry_tolerance: 0.02 #0.01 #0.0050
max_adjust: 8

[bed_mesh]
speed: 500
zero_reference_position: 150, 233
mesh_min: 0, -20 
mesh_max: 283,340
probe_count: 20, 20
algorithm: bicubic
bicubic_tension: 0.2
fade_start: 0.6
fade_end: 10
fade_target: 0

#####################################################################
# Heater bed
#####################################################################

[heater_bed]
heater_pin: PA1
max_power: 0.95
sensor_pin: PF3
sensor_type: Generic 3950
smooth_time: 1.0
pwm_cycle_time: 0.3
min_temp: -200
max_temp: 130
#control: pid
#pid_kp: 70.488 #63.238
#pid_ki: 0.702 #0.855
#pid_kd: 1169.116

#####################################################################
#	Extruder
#####################################################################

[extruder]
step_pin: nhk:gpio23
dir_pin: nhk:gpio24
enable_pin: !nhk:gpio25
rotation_distance: 4.637  	
microsteps: 16
full_steps_per_rotation: 200	
nozzle_diameter: 0.400
filament_diameter: 1.75
heater_pin: nhk:gpio9
sensor_pin: nhk:gpio29
sensor_type: magneto_adc
max_extrude_only_distance: 300.0
max_extrude_cross_section: 100.0
#adc_voltage: 3.3
pullup_resistor: 2200 #4700
min_temp:0
max_temp: 310
max_power: 0.75
min_extrude_temp: 175
pressure_advance: 0.020
pressure_advance_smooth_time: 0.020
#pid_version: 1
#pid_target: 240.00
#pid_tolerance: 0.0100
#control: pid_v
# Classic PID
#pid_kp: 13.867
#pid_ki: 0.859
#pid_kd: 55.992
# Cohen-Coon
#pid_Kp:23.172
#pid_Ki:1.307
#pid_Kd:45.424


#####################################################################
#	Verify heaters
#####################################################################

[verify_heater heater_bed]
max_error: 240
check_gain_time: 120
hysteresis: 5
heating_gain: 2

[verify_heater extruder]
max_error: 120
check_gain_time: 30
hysteresis: 5
heating_gain: 2

#####################################################################
#	Printer and board pins
#####################################################################

[printer]
kinematics: cartesian
max_velocity: 900
max_accel: 25000
max_z_velocity: 4.5
max_z_accel: 500   #1000

[board_pins]
aliases:
    # EXP1 header
    EXP1_1=PE8, EXP1_2=PE7,
    EXP1_3=PE9, EXP1_4=PE10,
    EXP1_5=PE12, EXP1_6=PE13,    # Slot in the socket on this side
    EXP1_7=PE14, EXP1_8=PE15,
    EXP1_9=<GND>, EXP1_10=<5V>,

    # EXP2 header
    EXP2_1=PA6, EXP2_2=PA5,
    EXP2_3=PB1, EXP2_4=PA4,
    EXP2_5=PB2, EXP2_6=PA7,      # Slot in the socket on this side
    EXP2_7=PC15, EXP2_8=<RST>,
    EXP2_9=<GND>, EXP2_10=PC5

#####################################################################
#	ADXL345
#####################################################################

[resonance_tester]
accel_chip: beacon
accel_per_hz: 100  # default is 75
probe_points: 150,200,20

#####################################################################
#	Input shaper
#####################################################################

[input_shaper]
shaper_type_y: smooth_zv
smoother_freq_y: 27.0
shaper_type_x: smooth_ei
smoother_freq_x: 42.0
enabled_extruders: extruder

#####################################################################
#	Misc
#####################################################################

[gcode_button kill_switch]
pin: !PG15
press_gcode: 
    PAUSE
    M118 X or Y motion is blocked.
    M107
    M104 S0
#    echo FIRMWARE_RESTART > /tmp/printer
#    echo RESTART > /tmp/printer

#####################################################################
#	5V LED
#####################################################################

[led LED]
white_pin: PD14
cycle_time: 0.010
hardware_pwm: False
initial_WHITE: 0.15

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [skew_correction calilantern_skew_profile]
#*# xy_skew = 0.00030405691003412155
#*# xz_skew = -0.0004666936565293689
#*# yz_skew = 0.00020506132198342048
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 70.0
#*# pid_ki = 0.7
#*# pid_kd = 1169.0
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	0.066113, 0.054076, 0.050963, 0.040760, 0.049503, 0.051910, 0.065662, 0.069304, 0.078199, 0.070446, 0.089237, 0.082516, 0.091852, 0.080305, 0.086850, 0.077055, 0.080545, 0.069272, 0.079911, 0.073274
#*# 	0.051220, 0.049104, 0.041777, 0.038278, 0.039859, 0.045093, 0.051294, 0.056966, 0.058718, 0.062888, 0.075187, 0.074158, 0.075049, 0.065993, 0.069359, 0.063897, 0.060478, 0.057550, 0.059049, 0.042736
#*# 	0.044587, 0.039073, 0.036713, 0.028855, 0.026482, 0.028108, 0.032052, 0.041986, 0.043205, 0.044969, 0.052776, 0.048084, 0.053274, 0.043757, 0.044385, 0.041386, 0.034787, 0.030153, 0.032747, 0.017956
#*# 	0.026146, 0.024490, 0.020194, 0.016912, 0.014876, 0.015140, 0.022346, 0.034251, 0.031028, 0.030393, 0.036556, 0.031114, 0.032160, 0.025131, 0.025715, 0.019334, 0.010966, 0.000206, 0.003925, -0.008963
#*# 	0.019497, 0.013408, 0.005914, 0.002295, -0.000383, -0.000246, 0.009107, 0.023427, 0.019227, 0.017167, 0.019590, 0.015946, 0.015259, 0.005621, 0.005927, -0.000126, -0.010186, -0.021446, -0.024020, -0.034994
#*# 	0.007750, -0.001401, -0.008647, -0.013705, -0.015395, -0.013563, -0.005782, 0.004702, 0.005457, 0.002735, 0.004800, -0.000534, -0.002924, -0.011081, -0.014813, -0.018405, -0.029505, -0.042399, -0.044536, -0.058147
#*# 	-0.006363, -0.016239, -0.023796, -0.025379, -0.026686, -0.028781, -0.018509, -0.012506, -0.010884, -0.013989, -0.009929, -0.021744, -0.018053, -0.028158, -0.028421, -0.034453, -0.044106, -0.060411, -0.060403, -0.077851
#*# 	-0.017333, -0.021154, -0.035207, -0.034054, -0.038376, -0.035611, -0.030822, -0.021215, -0.025197, -0.024256, -0.025159, -0.030556, -0.031663, -0.037562, -0.042272, -0.046766, -0.058238, -0.070921, -0.079013, -0.091563
#*# 	-0.025381, -0.030606, -0.043408, -0.044327, -0.049458, -0.042047, -0.040986, -0.027396, -0.033292, -0.028675, -0.033060, -0.034336, -0.038730, -0.041696, -0.051508, -0.050720, -0.067732, -0.076715, -0.091920, -0.099912
#*# 	-0.027445, -0.038237, -0.049246, -0.052607, -0.051898, -0.043106, -0.041714, -0.031994, -0.033117, -0.034534, -0.033607, -0.036010, -0.041597, -0.047218, -0.053220, -0.058799, -0.074624, -0.085888, -0.097606, -0.110245
#*# 	-0.033117, -0.039396, -0.052080, -0.056466, -0.054308, -0.048145, -0.042782, -0.036080, -0.037380, -0.039526, -0.038370, -0.044350, -0.042677, -0.054553, -0.054691, -0.060763, -0.077520, -0.090919, -0.105964, -0.117437
#*# 	-0.037094, -0.044247, -0.053173, -0.052699, -0.053556, -0.055482, -0.049401, -0.043357, -0.043248, -0.040660, -0.043375, -0.041687, -0.045750, -0.055249, -0.059861, -0.063356, -0.080715, -0.094264, -0.109677, -0.123693
#*# 	-0.037670, -0.040692, -0.047962, -0.046891, -0.051911, -0.046779, -0.047553, -0.032729, -0.040331, -0.035046, -0.038214, -0.037343, -0.045589, -0.051179, -0.054726, -0.059949, -0.076739, -0.088770, -0.105533, -0.117619
#*# 	-0.029516, -0.032781, -0.042700, -0.043768, -0.044987, -0.040800, -0.035450, -0.023999, -0.027324, -0.026321, -0.029477, -0.027743, -0.034983, -0.041784, -0.047968, -0.051535, -0.069174, -0.080128, -0.095832, -0.111213
#*# 	-0.023323, -0.024265, -0.037643, -0.036752, -0.041633, -0.031864, -0.029320, -0.012876, -0.017818, -0.011421, -0.015274, -0.005490, -0.021543, -0.027887, -0.036566, -0.037854, -0.056346, -0.065891, -0.082206, -0.099835
#*# 	-0.013736, -0.016104, -0.032564, -0.029223, -0.034828, -0.020259, -0.020565, 0.000988, -0.003809, 0.008540, 0.003822, 0.020309, -0.002249, -0.005131, -0.020547, -0.017165, -0.043404, -0.043084, -0.066768, -0.076453
#*# 	-0.008269, -0.009767, -0.023492, -0.021634, -0.023331, -0.010525, -0.006599, 0.015895, 0.017613, 0.029350, 0.018687, 0.026991, 0.014390, 0.014126, 0.003132, 0.004500, -0.021032, -0.026232, -0.046893, -0.059277
#*# 	-0.003970, 0.000042, -0.009535, -0.005286, -0.006926, 0.002710, 0.010279, 0.026444, 0.037730, 0.042512, 0.041363, 0.038778, 0.037193, 0.032728, 0.032905, 0.029989, 0.006519, -0.002491, -0.021527, -0.032442
#*# 	0.015503, 0.011186, 0.007949, 0.010990, 0.015497, 0.020339, 0.031076, 0.040179, 0.060094, 0.055304, 0.064103, 0.055513, 0.057789, 0.046624, 0.049383, 0.036853, 0.028173, 0.012414, 0.001004, -0.014408
#*# 	0.034560, 0.038800, 0.039730, 0.041473, 0.049530, 0.058246, 0.067757, 0.085474, 0.096123, 0.096912, 0.100258, 0.096993, 0.100384, 0.091740, 0.089499, 0.079882, 0.071134, 0.056737, 0.047546, 0.025261
#*# x_count = 20
#*# y_count = 20
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 0.0
#*# max_x = 283.0
#*# min_y = -20.0
#*# max_y = 310.0
#*#
#*# [telemetry]
#*# enabled = False
#*#
#*# [extruder]
#*# pid_version = 1
#*# pid_target = 225.00
#*# pid_tolerance = 0.0120
#*# control = pid_v
#*# pid_kp = 15.039
#*# pid_ki = 0.996
#*# pid_kd = 56.776
#*#
#*# [beacon model default]
#*# model_coef = 1.6506963817211722,
#*# 	  2.0123821809327938,
#*# 	  0.7740403576462671,
#*# 	  0.34485432272166044,
#*# 	  0.11248951132983132,
#*# 	  -0.22308930317875236,
#*# 	  0.0252528130862487,
#*# 	  0.4375398959686364,
#*# 	  0.03907337558093772,
#*# 	  -0.16858486403024583
#*# model_domain = 1.8899515260306462e-07,1.9397366025782743e-07
#*# model_range = 0.200000,5.000000
#*# model_temp = 48.550244
#*# model_offset = 0.18000
