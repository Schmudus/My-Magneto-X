[include beacon.cfg]
[include mainsail.cfg]
[include client_variable.cfg]
[include magneto_device.cfg]
[include magneto_toolhead.cfg]
[include shell_command.cfg]
[include macros.cfg]
[include bt_macro.cfg]
#[include timelapse.cfg]
[include stepper.cfg]
#[include TMC2240.cfg]
[include TMC5160.cfg]
[include temperatures.cfg]
[include neopixel.cfg]
[include fan_tach_monitor.cfg]
[include danger_options.cfg]
#[include shaketune.cfg]
[include AFC/*.cfg]
[include test_print.cfg]
[include TEST_SPEED.cfg]
[skew_correction]
[exclude_object]
[save_variables]
filename: ~/printer_data/config/variables.cfg
  
[idle_timeout]
gcode:
    {% if printer.pause_resume.is_paused %}
        M104 S0
    {% else %}
        LM_DISABLE
        TURN_OFF_HEATERS
        M84
        M118 Idle timeout
    {% endif %}
timeout: 3600

[gcode_arcs]
resolution: 0.1

[force_move]
enable_force_move: True

#####################################################################
#	Gantry level and Mesh
#####################################################################

[quad_gantry_level]
gantry_corners:
    -96,-78.5
    353.5,437

points:
  25,25
  25,350
  283,350
  283,25

speed: 350
horizontal_move_z: 10
retries: 8
retry_tolerance: 0.02 #0.01 #0.0050
max_adjust: 8

[bed_mesh]
speed: 500
zero_reference_position: 150, 233
mesh_min: 0, -20 
mesh_max: 283,350
probe_count: 20, 20
algorithm: bicubic
bicubic_tension: 0.2
fade_start: 0.6
fade_end: 10
fade_target: 0

#####################################################################
# Heater bed
#####################################################################

[heater_bed]
heater_pin: PA1
max_power: 0.95
sensor_pin: PF3
sensor_type: Generic 3950
smooth_time: 1.0
pwm_cycle_time: 0.3
min_temp: -200
max_temp: 130
#control: pid
#pid_kp: 70.488 #63.238
#pid_ki: 0.702 #0.855
#pid_kd: 1169.116

#####################################################################
#	Extruder
#####################################################################

[extruder]
step_pin: nhk:gpio23
dir_pin: nhk:gpio24
enable_pin: !nhk:gpio25
rotation_distance: 4.637  	
microsteps: 16
full_steps_per_rotation: 200	
nozzle_diameter: 0.400
filament_diameter: 1.75
heater_pin: nhk:gpio9
sensor_pin: nhk:gpio29
sensor_type: magneto_adc
max_extrude_only_distance: 300.0
max_extrude_cross_section: 100.0
#adc_voltage: 3.3
pullup_resistor: 2200 #4700
min_temp:0
max_temp: 310
max_power: 0.75
min_extrude_temp: 175
pressure_advance: 0.020
pressure_advance_smooth_time: 0.020
pid_version: 1
pid_target: 230.00
pid_tolerance: 0.0050
control: pid_v
pid_kp: 13.370
pid_ki: 0.775
pid_kd: 57.663

#####################################################################
#	Verify heaters
#####################################################################

[verify_heater heater_bed]
max_error: 240
check_gain_time: 120
hysteresis: 5
heating_gain: 2

[verify_heater extruder]
max_error: 120
check_gain_time: 30
hysteresis: 5
heating_gain: 2

#####################################################################
#	Printer and board pins
#####################################################################

[printer]
kinematics: cartesian
max_velocity: 900
max_accel: 25000
max_z_velocity: 4.5
max_z_accel: 500   #1000

[board_pins]
aliases:
    # EXP1 header
    EXP1_1=PE8, EXP1_2=PE7,
    EXP1_3=PE9, EXP1_4=PE10,
    EXP1_5=PE12, EXP1_6=PE13,    # Slot in the socket on this side
    EXP1_7=PE14, EXP1_8=PE15,
    EXP1_9=<GND>, EXP1_10=<5V>,

    # EXP2 header
    EXP2_1=PA6, EXP2_2=PA5,
    EXP2_3=PB1, EXP2_4=PA4,
    EXP2_5=PB2, EXP2_6=PA7,      # Slot in the socket on this side
    EXP2_7=PC15, EXP2_8=<RST>,
    EXP2_9=<GND>, EXP2_10=PC5

#####################################################################
#	ADXL345
#####################################################################

[resonance_tester]
accel_chip: beacon
accel_per_hz: 100  # default is 75
probe_points: 150,200,20

#####################################################################
#	Input shaper
#####################################################################

[input_shaper]
shaper_type_y: smooth_zv
smoother_freq_y: 27.0
shaper_type_x: smooth_ei
smoother_freq_x: 42.0
enabled_extruders: extruder

#####################################################################
#	Misc
#####################################################################

[gcode_button kill_switch]
pin: !PG15
press_gcode: 
    PAUSE
    M118 X or Y motion is blocked.
    M107
    M104 S0
#    echo FIRMWARE_RESTART > /tmp/printer
#    echo RESTART > /tmp/printer

#####################################################################
#	5V LED
#####################################################################

[led LED]
white_pin: PD14
cycle_time: 0.010
hardware_pwm: False
initial_WHITE: 0.15

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [skew_correction calilantern_skew_profile]
#*# xy_skew = 0.00030405691003412155
#*# xz_skew = -0.0004666936565293689
#*# yz_skew = 0.00020506132198342048
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 70.0
#*# pid_ki = 0.7
#*# pid_kd = 1169.0
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	  0.036070, 0.018239, 0.021763, 0.010736, 0.026071, 0.027606, 0.054300, 0.065560, 0.077025, 0.059022, 0.076125, 0.067067, 0.083852, 0.065152, 0.079322, 0.062564, 0.061928, 0.041351, 0.047630, 0.036130
#*# 	  0.032356, 0.025968, 0.019763, 0.020439, 0.027455, 0.044968, 0.066029, 0.081347, 0.077866, 0.072892, 0.076986, 0.065014, 0.064779, 0.054667, 0.064700, 0.055460, 0.052329, 0.037158, 0.038315, 0.008296
#*# 	  0.023677, 0.018953, 0.014013, 0.015904, 0.019699, 0.036480, 0.054350, 0.072797, 0.066190, 0.059586, 0.058448, 0.047662, 0.046785, 0.043294, 0.041580, 0.036082, 0.027560, 0.015554, 0.011900, -0.012550
#*# 	  0.014361, 0.009823, 0.002886, 0.004336, 0.005857, 0.018638, 0.035527, 0.050753, 0.047647, 0.040353, 0.040215, 0.030932, 0.027613, 0.018205, 0.016599, 0.007675, -0.005012, -0.018040, -0.017346, -0.039242
#*# 	  0.010698, 0.003052, -0.002290, -0.007357, -0.007322, -0.000492, 0.008765, 0.019603, 0.024356, 0.018186, 0.021077, 0.011184, 0.009586, -0.003598, -0.005812, -0.013337, -0.025251, -0.040599, -0.041610, -0.062934
#*# 	  -0.004947, -0.018256, -0.018232, -0.019893, -0.015011, -0.010415, -0.003768, 0.005154, 0.009351, 0.005110, 0.005305, -0.005547, -0.003533, -0.016890, -0.019827, -0.031086, -0.040872, -0.058038, -0.059454, -0.083155
#*# 	  -0.017256, -0.023517, -0.027486, -0.025861, -0.022898, -0.019902, -0.012300, -0.006966, -0.000912, -0.007266, -0.007278, -0.015365, -0.009107, -0.024121, -0.032340, -0.046886, -0.055272, -0.073067, -0.077796, -0.100118
#*# 	  -0.023176, -0.024239, -0.021061, -0.020230, -0.020535, -0.020339, -0.018246, -0.012087, -0.011061, -0.014087, -0.011106, -0.019539, -0.019052, -0.029761, -0.038645, -0.050067, -0.067650, -0.081323, -0.089645, -0.112434
#*# 	  -0.023938, -0.032984, -0.040630, -0.044790, -0.027035, -0.022634, -0.021780, -0.013924, -0.015588, -0.012433, -0.013553, -0.020094, -0.020517, -0.030963, -0.039750, -0.052945, -0.073719, -0.089086, -0.099099, -0.122728
#*# 	  -0.026419, -0.045343, -0.056027, -0.052137, -0.041604, -0.031861, -0.026197, -0.018013, -0.018301, -0.015168, -0.019472, -0.019311, -0.019030, -0.029447, -0.043156, -0.056724, -0.081682, -0.094770, -0.110882, -0.130852
#*# 	  -0.045795, -0.053968, -0.062043, -0.048719, -0.042909, -0.037301, -0.037560, -0.023003, -0.025938, -0.018359, -0.027614, -0.026316, -0.026733, -0.038290, -0.050490, -0.060317, -0.086860, -0.096157, -0.115369, -0.133203
#*# 	  -0.047827, -0.050868, -0.055012, -0.045004, -0.038199, -0.038645, -0.037557, -0.023132, -0.026450, -0.019247, -0.028105, -0.027466, -0.035198, -0.042934, -0.051380, -0.059859, -0.081493, -0.092010, -0.111781, -0.128716
#*# 	  -0.042285, -0.045928, -0.048699, -0.045480, -0.035527, -0.037319, -0.035640, -0.026214, -0.025828, -0.024137, -0.029494, -0.027812, -0.034328, -0.043141, -0.049003, -0.055137, -0.076119, -0.086208, -0.102709, -0.122572
#*# 	  -0.036950, -0.043346, -0.051678, -0.051570, -0.043757, -0.034307, -0.029773, -0.023088, -0.023639, -0.022016, -0.020063, -0.011917, -0.020285, -0.031241, -0.036390, -0.042945, -0.062010, -0.071076, -0.089019, -0.109852
#*# 	  -0.026009, -0.033174, -0.046584, -0.045025, -0.037934, -0.022809, -0.017311, -0.005436, -0.005831, -0.000746, -0.003379, 0.010433, -0.000299, -0.010193, -0.018565, -0.017832, -0.043090, -0.053220, -0.071021, -0.091177
#*# 	  -0.023490, -0.029729, -0.040897, -0.036510, -0.029368, -0.013257, -0.003480, 0.009488, 0.011056, 0.017473, 0.009133, 0.018344, 0.012820, 0.009810, 0.010534, 0.008973, -0.015539, -0.032953, -0.050997, -0.069882
#*# 	  -0.015796, -0.016183, -0.028325, -0.019912, -0.012402, 0.007838, 0.010111, 0.027124, 0.029335, 0.041860, 0.028787, 0.041152, 0.031203, 0.035073, 0.025027, 0.022743, -0.002668, -0.012785, -0.028425, -0.046922
#*# 	  -0.000086, 0.000044, 0.001996, 0.021485, 0.029054, 0.040077, 0.032592, 0.053229, 0.054584, 0.063672, 0.054155, 0.062750, 0.057851, 0.057615, 0.048480, 0.044282, 0.021361, 0.015990, -0.000471, -0.018575
#*# 	  0.014794, 0.021777, 0.017856, 0.036817, 0.043857, 0.062412, 0.057757, 0.080501, 0.073700, 0.089336, 0.077009, 0.091814, 0.082293, 0.087034, 0.072986, 0.073729, 0.052865, 0.047549, 0.032292, 0.010078
#*# 	  0.036808, 0.038307, 0.051459, 0.059972, 0.072759, 0.079879, 0.096339, 0.105134, 0.113829, 0.110813, 0.124661, 0.117714, 0.133784, 0.115517, 0.123951, 0.104955, 0.105982, 0.089100, 0.088378, 0.060616
#*# x_count = 20
#*# y_count = 20
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 0.0
#*# max_x = 283.0
#*# min_y = -20.0
#*# max_y = 340.0
#*#
#*# [telemetry]
#*# enabled = False
#*#
#*# [beacon model default]
#*# model_coef = 1.6197605159305153,
#*# 	  1.9678256111451133,
#*# 	  0.7771414662353653,
#*# 	  0.434922524298901,
#*# 	  0.21345529456095944,
#*# 	  -0.34215670942493637,
#*# 	  -0.1176342144866798,
#*# 	  0.5636877677883764,
#*# 	  0.10778113278767082,
#*# 	  -0.2207168213659916
#*# model_domain = 1.8901009609704412e-07,1.9402450834875182e-07
#*# model_range = 0.200000,5.000000
#*# model_temp = 74.823177
#*# model_offset = 0.07000
